// Final test config for EFS mounting with Seqera Compute
// Testing if Nextflow config can override Platform's volume settings

// Customer issue: When configuring EFS/FSx mount in Seqera Platform UI,
// the volumes setting gets overridden to just 'volumes = "/staging"'
// instead of properly mounting the EFS/FSx filesystem.

// EFS Configuration
params {
    efs_id = "fs-030e6f671ce998fa2"
    mount_path = "/staging/scratch"
}

// Docker containerOptions with explicit EFS mount
// This is the ONLY safe way to try volume mounts with Seqera Compute
// (aws.batch config blocks cause stalls with Seqera Compute)
process {
    containerOptions = "--volume ${params.efs_id}:${params.mount_path}"
}

// Fusion and Wave - required by Seqera Compute
fusion {
    enabled = true
    exportStorageCredentials = true
}

wave {
    enabled = true
}
